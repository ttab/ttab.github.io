<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="10 14 690 516" width="690pt" height="43pc" xmlns:dc="http://purl.org/dc/elements/1.1/"><metadata> Produced by OmniGraffle 6.0.1 <dc:date>2013-10-29 19:46Z</dc:date></metadata><defs><marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="black"><g><path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/></g></marker><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="-1e3" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-style="italic" font-weight="500"><font-face-src><font-face-name name="Helvetica-Oblique"/></font-face-src></font-face><font-face font-family="Helvetica Neue" font-size="16" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.99585" descent="-212.99744" font-weight="500"><font-face-src><font-face-name name="HelveticaNeue"/></font-face-src></font-face><font-face font-family="Osaka" font-size="10" panose-1="2 11 6 0 0 0 0 0 0 0" units-per-em="1000" underline-position="0" underline-thickness="118.07575" slope="0" x-height="558.59375" cap-height="781.25" ascent="1e3" descent="-250" font-weight="500"><font-face-src><font-face-name name="Osaka"/></font-face-src></font-face></defs><g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>Canvas 1</title><rect fill="white" width="806" height="536"/><g><title>Layer 1</title><rect x="68.031496" y="25.511811" width="28.346457" height="462.04724" fill="#cce6ff"/><rect x="68.031496" y="25.511811" width="28.346457" height="462.04724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="308.97638" y="59.737532" width="28.346457" height="407.979" fill="#ffcaf9"/><rect x="308.97638" y="59.737532" width="28.346457" height="407.979" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="549.92126" y="25.511811" width="28.346457" height="462.04724" fill="#fff9c4"/><rect x="549.92126" y="25.511811" width="28.346457" height="462.04724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="96.37795" y1="36.850393" x2="540.02126" y2="36.850393" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="247.31244" y="24.850393" width="142" height="24" fill="white"/><text transform="translate(252.31244 29.850393)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".19042969" y="11" textLength="24.667969">1. W</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="24.418945" y="11" textLength="107.390625">ant to log in with OP</tspan></text><line x1="549.92126" y1="70.86614" x2="347.22283" y2="70.86614" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="367.83588" y="58.86614" width="115" height="24" fill="white"/><text transform="translate(372.83588 63.86614)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="2.1503906" y="11" textLength="104.033203">2. XRDS discovery </tspan></text><line x1="549.92126" y1="107.716535" x2="347.22283" y2="107.716535" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="367.43353" y="95.716535" width="138" height="24" fill="white"/><text transform="translate(372.43353 100.716535)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.9638672" y="11" textLength="127.40625">3. Set up shared secret </tspan></text><line x1="549.92126" y1="141.73228" x2="106.27795" y2="141.73228" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="354.01947" y="129.73228" width="178" height="24" fill="white"/><text transform="translate(359.01947 134.73228)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".052734375" y="11" textLength="92.03906">4. Redirect to OP</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="91.88086" y="11" textLength="76.066406"> auth endpoint</tspan></text><line x1="96.37795" y1="156.22835" x2="299.07638" y2="156.22835" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><line x1="308.97638" y1="195.59055" x2="106.27795" y2="195.59055" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="96.37795" y1="209.76378" x2="299.07638" y2="209.76378" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><line x1="308.97638" y1="243.77953" x2="106.27795" y2="243.77953" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="96.37795" y1="257.95275" x2="299.07638" y2="257.95275" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="127.695685" y="231.77953" width="165" height="24" fill="white"/><text transform="translate(132.695685 236.77953)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".4609375" y="11" textLength="154.078125">6. Redirect back to auth URL</tspan></text><rect x="124.94178" y="183.59055" width="141" height="24" fill="white"/><text transform="translate(129.94178 188.59055)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="2.1279297" y="11" textLength="130.078125">5. Bounce cookie check </tspan></text><line x1="308.97638" y1="283.46457" x2="106.27795" y2="283.46457" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="125.55506" y="271.46457" width="114" height="24" fill="white"/><text transform="translate(130.55506 276.46457)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.9726562" y="11" textLength="103.38867">7. Redirect to login </tspan></text><line x1="96.37795" y1="334.48819" x2="299.07638" y2="334.48819" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="126.70161" y="322.48819" width="161" height="24" fill="white"/><text transform="translate(131.70161 327.48819)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".45898438" y="11" textLength="150.08203">8. Provides login credentials</tspan></text><line x1="308.97638" y1="368.50393" x2="106.27795" y2="368.50393" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="125.832404" y="356.50393" width="165" height="24" fill="white"/><text transform="translate(130.8324 361.50393)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".4609375" y="11" textLength="154.078125">9. Redirect back to auth URL</tspan></text><line x1="337.32283" y1="82.204724" x2="540.02126" y2="82.204724" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><line x1="337.32283" y1="119.05512" x2="540.02126" y2="119.05512" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><line x1="96.37795" y1="297.6378" x2="299.07638" y2="297.6378" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><line x1="308.97638" y1="306.14173" x2="106.27795" y2="306.14173" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="141.559054" y="291.9685" width="86" height="24" fill="white"/><text transform="translate(146.559054 296.9685)" fill="black"><tspan font-family="Helvetica" font-size="12" font-style="italic" font-weight="500" x=".30078125" y="11" textLength="75.398438">get login page</tspan></text><line x1="96.37795" y1="379.84252" x2="299.07638" y2="379.84252" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><line x1="308.97638" y1="408.18897" x2="106.27795" y2="408.18897" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="121.3324" y="396.18897" width="174" height="24" fill="white"/><text transform="translate(126.3324 401.18897)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".059570312" y="11" textLength="37.353516">10. OP</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="37.202148" y="11" textLength="126.73828"> signs logged in redirect</tspan></text><line x1="96.37795" y1="430.86614" x2="540.02126" y2="430.86614" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="138.82416" y="418.86614" width="123" height="24" fill="white"/><text transform="translate(143.82416 423.86614)" fill="black"><tspan font-family="Helvetica" font-size="12" font-style="italic" font-weight="500" x=".12988281" y="11" textLength="112.740234">provides signed login</tspan></text><line x1="549.92126" y1="450.70866" x2="347.22283" y2="450.70866" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><rect x="382.88946" y="438.70866" width="126" height="24" fill="white"/><text transform="translate(387.88946 443.70866)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x=".077148438" y="11" textLength="6.673828">1</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="5.866211" y="11" textLength="21.345703">1. V</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="26.555664" y="11" textLength="19.335938">erifi</tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="45.891602" y="11" textLength="70.03125">es claimed id</tspan></text><line x1="337.32283" y1="462.04724" x2="540.02126" y2="462.04724" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="555.90945" y="422.3622" width="60" height="38" fill="white"/><text transform="translate(560.90945 427.3622)" fill="black"><tspan font-family="Helvetica" font-size="12" font-style="italic" font-weight="500" x="5.9951172" y="11" textLength="25.335938">verifi</tspan><tspan font-family="Helvetica" font-size="12" font-style="italic" font-weight="500" x="31.331055" y="11" textLength="12.673828">es</tspan><tspan font-family="Helvetica" font-size="12" font-style="italic" font-weight="500" x=".31738281" y="25" textLength="49.365234">signature</tspan></text><text transform="translate(70.19685 496.3937)" fill="black"><tspan font-family="Helvetica Neue" font-size="16" font-weight="500" x=".04" y="15" textLength="21.92">UA</tspan></text><text transform="translate(312.406 496.3937)" fill="black"><tspan font-family="Helvetica Neue" font-size="16" font-weight="500" x=".236" y="15" textLength="22.528">OP</tspan></text><text transform="translate(554.35088 496.3937)" fill="black"><tspan font-family="Helvetica Neue" font-size="16" font-weight="500" x=".336" y="15" textLength="21.328">RP</tspan></text><rect x="498.7047" y="320.7874" width="190.11419" height="22.204724" fill="white"/><rect x="498.7047" y="320.7874" width="190.11419" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(503.7047 324.38976)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="101.75781">https://tt.se/o/login</tspan></text><rect x="365.47636" y="320.7874" width="133.228346" height="22.204724" fill="#ffcaf9"/><rect x="365.47636" y="320.7874" width="133.228346" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(370.47636 324.38976)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="42.070312">OP Login</tspan></text><rect x="365.47636" y="298.58268" width="133.228346" height="22.204724" fill="#ffcaf9"/><rect x="365.47636" y="298.58268" width="133.228346" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(370.47636 302.18504)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="120.390625">OP OpenId Auth Endpoint</tspan></text><rect x="498.7047" y="298.58268" width="190.11419" height="22.204724" fill="white"/><rect x="498.7047" y="298.58268" width="190.11419" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(503.7047 302.18504)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="144.765625">https://tt.se/o/openid2/auth</tspan></text><rect x="498.7047" y="276.37795" width="190.11419" height="22.204724" fill="white"/><rect x="498.7047" y="276.37795" width="190.11419" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(503.7047 279.98031)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="154.49219">https://tt.se/o/id?id=someuser</tspan></text><rect x="365.47636" y="276.37795" width="133.228346" height="22.204724" fill="#ffcaf9"/><rect x="365.47636" y="276.37795" width="133.228346" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(370.47636 279.98031)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="76.953125">OP User Identity</tspan></text><rect x="365.47636" y="254.17323" width="133.228346" height="22.204724" fill="#ffcaf9"/><rect x="365.47636" y="254.17323" width="133.228346" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(370.47636 257.77559)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="106.25">OP Id Endpoint (XRDS)</tspan></text><rect x="498.7047" y="254.17323" width="190.11419" height="22.204724" fill="white"/><rect x="498.7047" y="254.17323" width="190.11419" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(503.7047 257.77559)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="87.46094">https://tt.se/o/id</tspan></text><rect x="365.47636" y="215.90551" width="133.228346" height="22.204724" fill="#fff9c4"/><rect x="365.47636" y="215.90551" width="133.228346" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(370.47636 219.50787)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="67.695312">RP Return URL</tspan></text><rect x="498.7047" y="215.90551" width="190.11419" height="22.204724" fill="white"/><rect x="498.7047" y="215.90551" width="190.11419" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(503.7047 219.50787)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="145.859375">https://site.tt.se/login/return</tspan></text><rect x="498.7047" y="193.70079" width="190.11419" height="22.204724" fill="white"/><rect x="498.7047" y="193.70079" width="190.11419" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(503.7047 197.30315)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="110.9375">https://site.tt.se/login</tspan></text><rect x="365.47636" y="193.70079" width="133.228346" height="22.204724" fill="#fff9c4"/><rect x="365.47636" y="193.70079" width="133.228346" height="22.204724" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(370.47636 197.30315)" fill="black"><tspan font-family="Osaka" font-size="10" font-weight="500" x="0" y="10" textLength="40.78125">RP Login</tspan></text><text transform="translate(25.84252 197.22047) rotate(-90)" fill="black"><tspan font-family="Helvetica Neue" font-size="16" font-weight="500" x=".492" y="15" textLength="160.016">TT OpenID Login Flow</tspan></text><line x1="549.92126" y1="481.88976" x2="106.27795" y2="481.88976" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke-dasharray="4,4"/><rect x="261.28346" y="470.55118" width="124" height="24" fill="white"/><text transform="translate(266.28346 475.55118)" fill="black"><tspan font-family="Helvetica" font-size="12" font-style="italic" font-weight="500" x=".29882812" y="11" textLength="113.402344">is logged in using OP</tspan></text></g></g></svg>
